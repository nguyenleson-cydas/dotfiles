# ================================
# SOLARIZED OSAKA COLOR PALETTE
# ================================

# Base colors
sol_base03="#00141A"
sol_base02="#002B36"
sol_base01="#073642"
sol_base00="#586E75"
sol_base0="#657B83"
sol_base1="#9EACAD"
sol_base2="#EEE8D5"
sol_base3="#FDF6E3"

# Accent colors
sol_yellow="#B58900"
sol_orange="#CB4B16"
sol_red="#DC322F"
sol_magenta="#D33682"
sol_violet="#6C71C4"
sol_blue="#268BD2"
sol_cyan="#2AA198"
sol_green="#859900"

# Additional optimized colors
sol_dark_blue="#103956"
sol_teal="#103B3D"
sol_bright_cyan="#29EEDF"
sol_light_blue="#49AEF5"
sol_bright_violet="#494FB6"

# ================================
# GENERAL SETTINGS
# ================================

set -g default-terminal "${TERM}"

# Undercurl support
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'

# True color support
set-option -sa terminal-overrides ",xterm*:Tc"

# Enable mouse support
set -g mouse on

# Increase history limit
set -g history-limit 10000

# Set escape time to 0 for faster command sequences
set -sg escape-time 0

# Enable focus events
set -g focus-events on

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

# ================================
# KEY BINDINGS
# ================================

# Reload config with prefix + r
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# Vim style pane selection
bind h select-pane -L
bind j select-pane -D 
bind k select-pane -U
bind l select-pane -R

# Use Option (Alt) + arrow keys without prefix to switch panes
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Shift + arrow to switch windows
bind -n S-Left  previous-window
bind -n S-Right next-window

# Shift + Option (Alt) + vim keys to switch windows
bind -n M-H previous-window
bind -n M-L next-window

# Better split commands (open in current path)
# bind '"' split-window -v -c "#{pane_current_path}"
# bind % split-window -h -c "#{pane_current_path}"
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# New window in current path
bind c new-window -c "#{pane_current_path}"

# Resize panes with prefix + HJKL
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Toggle pane zoom with Option (Alt) + f
bind -n M-f resize-pane -Z

# Open htop in popup with prefix + H
bind H display-popup -E "htop"

# ================================
# COPY MODE (VI)
# ================================

# Use vi key bindings in copy mode
set-window-option -g mode-keys vi

# Copy mode bindings
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Enter copy mode with prefix + [
bind [ copy-mode

# ================================
# STATUS BAR CONFIGURATION
# ================================

# Enable status bar
set -g status on
set -g status-interval 5
set -g status-position bottom

# Status bar length
set -g status-left-length 50
set -g status-right-length 100

# Basic status bar colors
set -g status-style "bg=$sol_base03,fg=$sol_base0"

# Left status: session name
set -g status-left "#[fg=$sol_blue,bold] 「#S」 #[default] "

# Right status: CPU, RAM, and time
set -g status-right "#[fg=$sol_cyan]#{cpu_icon} #{cpu_percentage} #[fg=$sol_green]#{ram_icon} #{ram_percentage} #[fg=$sol_base0] %Y-%m-%d %H:%M "

# ================================
# WINDOW STATUS STYLING
# ================================

# Default window status
set -g window-status-style "bg=$sol_base03,fg=$sol_base01"

# Current window status
set -g window-status-current-style "bg=$sol_base02,fg=$sol_blue,bold"

# Window with activity status
set -g window-status-activity-style "bg=$sol_base03,fg=$sol_green"

# Window with bell status
set -g window-status-bell-style "bg=$sol_red,fg=$sol_base3,bold"

# Window status format with icons only
set -g window-status-format " #I ○ "
set -g window-status-current-format " #I ● "

# Window separator
set -g window-status-separator ""

# ================================
# PANE STYLING
# ================================

# Pane borders - make inactive panes very subtle (almost invisible)
set -g pane-border-style "fg=$sol_base02"

# Active pane border - make it very visible with bright orange
# This creates a strong visual contrast against the solarized dark background
set -g pane-active-border-style "fg=$sol_orange,bold"

# Pane border titles - show file name at top of pane
set -g pane-border-status top
set -g pane-border-format " #{b:pane_current_path} | #{pane_title} "

# Pane number display
set -g display-panes-active-colour "$sol_blue"
set -g display-panes-colour "$sol_base0"

# Display pane numbers for 2 seconds
set -g display-panes-time 2000

# ================================
# MESSAGE STYLING
# ================================

# Message text
set -g message-style "bg=$sol_base02,fg=$sol_blue,bold"
set -g message-command-style "bg=$sol_base02,fg=$sol_blue"

# Display messages for 2 seconds
set -g display-time 2000

# ================================
# COPY MODE STYLING
# ================================

# Copy mode highlighting
set -g mode-style "bg=$sol_base02,fg=$sol_blue"

# ================================
# OTHER STYLING
# ================================

# Clock mode
set -g clock-mode-colour "$sol_blue"
set -g clock-mode-style 24

# ================================
# WINDOW MONITORING
# ================================

# Monitor for activity in windows
set -g monitor-activity on
set -g visual-activity off

# ================================
# PLUGINS
# ================================

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'fcsonline/tmux-thumbs'

# CPU plugin configuration
set -g @cpu_low_icon "✓"
set -g @cpu_medium_icon "⚠"
set -g @cpu_high_icon "✖"
set -g @ram_low_icon "✓"
set -g @ram_medium_icon "⚠"
set -g @ram_high_icon "✖"

set -g @thumbs-command 'echo -n {} | pbcopy'

# Initialize TPM (keep this line at the very bottom)
run-shell ~/.config/tmux/plugins/tmux-thumbs/tmux-thumbs.tmux
run '~/.config/tmux/plugins/tpm/tpm'
